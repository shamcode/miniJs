miJs=miniJs=function(){function b(a,b){var c=!!b;this.result=void 0,this.chain=function(){return c=!c,c?this:this.result},this.clone=function(b,d){a=this.result||a;var e=function(a,b,c){var d=a instanceof Array?[]:{};for(var e in a)!!c!=(b.indexOf?b.indexOf(e)!==-1:miJs.object(e).in(b))&&(d[e]=typeof a[e]=="object"?arguments.callee(a[e]):a[e]);return d}(a,b,d);return c?e instanceof Array?miJs.array(e,!0):(this.result=e,this):e},this.equal=function(b){a=this.result||a;var d=function(a,b){if(a==void 0||b==void 0)return a==b;if(a.length!=b.length)return!1;for(var c in a)if(typeof a[c]=="object"){if(!b[c]||!arguments.callee(a[c],b[c]))return!1}else if(typeof a[c]=="function"){if(a[c]+""!=b[c]+"")return!1}else if(a[c]!==b[c])return!1;return a.length==void 0&&a+""!=b+""?!1:!0}(a,b);return c?(this.result=d,this):d},this.in=function(b){a=this.result||a;for(var d in b)if(miJs.object(a).equal(b[d]))return c?(this.result=!0,this):!0;return c?(this.result=!1,this):!1},this.alert=function(b,d){a=this.result!==void 0?this.result:a;var e="";for(var f in a)e+=d?miniJs.object(f).in(b)?"":f+"="+(a[f]+"")+"\n":b?miniJs.object(f).in(b)?f+"="+(a[f]+"")+"\n":"":f+"="+(a[f]==void 0?"":a[f]+"")+"\n";return typeof a!="object"&&(e+=a+""),alert(e),c?this:void 0},this.set=function(b,d){a=this.result||a;for(var e in b)d&&a[e]!==void 0||(typeof b[e]=="object"?(a[e]==void 0&&(a[e]=b[e]instanceof Array?[]:{}),miniJs.object(a[e]).set(b[e])):a[e]=typeof b[e]=="function"?miniJs.function(b[e]).clone():b[e]);return c?this:void 0},this.with=function(){return a=this.result||a,miniJs.this=a,c?this:void 0},this.diff=function(b,d){a=this.result||a;var e=[];for(var f in a)b[f]&&miJs.object(a[f]).equal(b[f])||e.push(f);var g=miJs.object(d?b:a).clone(e);return miJs.array(e).each(function(a){g[a]==void 0&&(g[a]=void 0)}),c?(this.result=g,this):g}}function c(a,b){var c=!!b;this.result=void 0,this.chain=function(){return c=!c,c?this:this.result},this.clone=function(){return a=this.result||a,c?(this.result=a.slice(0),this):a.slice(0)},this.equal=function(b){return a=this.result||a,c?(this.result=miJs.object(a).equal(b),this):miJs.object(a).equal(b)},this.alert=function(){a=this.result!==void 0?this.result:a;var b="";for(var d in a)b+=d+"="+(a[d]+"")+"\n";return typeof a!="object"&&(b+=""+a),alert(b),c?this:void 0},this.map=function(b){if(a=this.result||a,a.map!==void 0)return c?(this.result=a.map(b),this):a.map(b);var d=[];for(var e in a)d.push(b(a[e]));return c?(this.result=d,this):d},this.filter=function(b){if(a=this.result||a,a.filter!==void 0)return c?(this.result=a.filter(b),this):a.filter(b);var d=[];for(var e in a)b(a[e])&&d.push(a);return c?(this.result=d,this):d},this.uniq=function(){a=this.result||a;var b=[];for(var d in a)if(!miJs.object(a[d]).in(b)){var e=0;for(var f in a)if(e+=miJs.object(a[d]).equal(a[f])?1:0,e>1){b.push(a[d]);break}e==1&&b.push(a[d])}return c?(this.result=b,this):b},this.delete=function(a){var b=this.filter(function(b){return!miJs.object(b).equal(a)});return c?this:b},this.each=function(b){if(a=this.result||a,a.forEach!==void 0)return c?(a.forEach(b),this):a.forEach(b);for(var d in a)b(a[d]);return c?this:void 0}}function d(b,c){var d=!!c;this.result=void 0,this.chain=function(){return d=!d,d?this:this.result},this.cache=function(){var a=function(){for(var c in a.base.argument)if(a.base.argument.hasOwnProperty(c)&&miniJs.object(a.base.argument[c]).equal(arguments))return a.base.retValue[c];a.base.argument.push(arguments);var d=b.apply(this,arguments);return a.base.retValue.push(d),d};if(a.base={argument:[],retValue:[]},d){var c=miJs.function(a,!0);return c.result=a,c}return a},this.log=function(){var a=function(){var c=b.apply(this,arguments);a.log.push({args:arguments,ret:c})};if(a.log=[],d){var c=miJs.function(a,!0);return c.result=a,c}return a},this.clone=function(){var c=function(){return b.apply({},arguments)};for(var f in b)c[f]=b[f];if(d){var g=miJs.function(c,!0);return g.result=c,g}return a}}var a=function(){return arguments.length?arguments[0]instanceof Array?new c(arguments[0],arguments[1]):typeof arguments[0]=="function"?new d(arguments[0],arguments[1]):new b(arguments[0],arguments[1]):void 0};return a.object=function(a,c){return new b(a,c)},a.function=function(a,b){return new d(a,b)},a.array=function(a,b){return new c(a,b)},a.this=void 0,a}()