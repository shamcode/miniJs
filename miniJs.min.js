miJs=miniJs=function(){function t(t,e){var i=!!e;this.result=void 0,this.chain=function(){return i=!i,i?this:this.result},this.clone=function(e,n){t=this.result||t;var r=function(t,e,i){for(var n=t instanceof Array?[]:{},r=0,s=miJs.object(t).keys();r<s.length;r++){var u=s[r];e&&!!i==(e&&e.indexOf?-1!==e.indexOf(u):miJs.object(u).in(e))||(n[u]="object"==typeof t[u]?arguments.callee(t[u]):t[u])}return n}(t,e,n);return i?r instanceof Array?miJs.array(r,!0):(this.result=r,this):r},this.equal=function(e){t=this.result||t;var n=function(t,e){if(void 0==t||void 0==e)return t==e;if(t.length!=e.length)return!1;if(t.toString()!=e.toString())return!1;if(!isNaN(t)&&!isNaN(e))return t==e;if(("string"==typeof t||t instanceof String)&&("string"==typeof e||e instanceof String))return t==e;for(var i=0,n=miJs.object(t).keys();i<n.length;i++){var r=n[i];if("object"==typeof t[r]){if(!e[r]||!arguments.callee(t[r],e[r]))return!1}else if("function"==typeof t[r]){if(t[r].toString()!=e[r].toString())return!1}else if(t[r]!==e[r])return!1}return!0}(t,e);return i?(this.result=n,this):n},this.in=function(e){t=this.result||t;for(var n=0;n<e.length;n++)if(miJs.object(t).equal(e[n]))return i?(this.result=!0,this):!0;return i?(this.result=!1,this):!1},this.alert=function(e,n){t=void 0!==this.result?this.result:t;for(var r="",s=0,u=t.keys();s<u.length;s++){var o=u[s];r+=n?miniJs.object(o).in(e)?"":o+"="+t[o].toString()+"\n":e?miniJs.object(o).in(e)?o+"="+t[o].toString()+"\n":"":o+"="+(void 0==t[o]?"":t[o].toString())+"\n"}return("object"!=typeof t)>(t instanceof Array)&&(r=t.toString()),alert(r),i?this:void 0},this.set=function(e,n){t=this.result||t;for(var r="function"==typeof n,s=0,u=miJs.object(e).keys();s<u.length;s++){var o=u[s];if(r){if(!n(t,e,o))continue}else if(n&&void 0!==t[o])continue;"object"==typeof e[o]?(void 0==t[o]&&(t[o]=e[o]instanceof Array?[]:{}),miniJs.object(t[o]).set(e[o],n)):t[o]="function"==typeof e[o]?miniJs.function(e[o]).clone():e[o]}return i?this:void 0},this.with=function(){return t=this.result||t,miniJs.this=t,i?this:void 0},this.diff=function(e,n){t=this.result||t;for(var r=[],s=0,u=miJs.object(t).keys();s<u.length;s++){var o=u[s];miJs.object(t[o]).equal(e[o])||r.push(o)}var a=miJs.object(n?e:t).clone(r);return i?(this.result=a,this):a},this.keys=function(){if(t=this.result||t,void 0!==Object.keys)return i?(this.result=Object.keys(t),this):Object.keys(t);var e=[];for(var n in t)e.push(n);return i?(this.result=e,this):e},this.value=function(e){return t=this.result||t,i?(this.result=t[e],this):t[e]},this.key=function(e){t=this.result||t;for(var n=0,r=miJs.object(t).keys();n<r.length;n++){var s=r[n];if(miJs.object(t[s]).equal(e))return i?(this.result=s,this):s}return i?(this.result=void 0,this):void 0},this.array=function(){t=this.result||t;var e=miJs.array(t,i);return i?(e.result=t,e):e},this.function=function(){t=this.result||t;var e=miJs.function(t,i);return i?(e.result=t,e):e},this.external=function(e,i){t=this.result||t;var n=e(t);return i&&(this.result=n),this}}function e(t,e){var i=!!e;this.result=void 0,this.chain=function(){return i=!i,i?this:this.result},this.clone=function(){return t=this.result||t,i?(this.result=miJs.object(t).clone(),this):miJs.object(t).clone()},this.equal=function(e){return t=this.result||t,i?(this.result=miJs.object(t).equal(e),this):miJs.object(t).equal(e)},this.alert=function(){t=void 0!==this.result?this.result:t;for(var e="",n=0;n<t.length;n++)e+=n+"="+t[n].toString()+"\n";return"object"!=typeof t&&(e+=""+t),alert(e),i?this:void 0},this.map=function(e){if(t=this.result||t,"string"==typeof e&&(e=miJs.string(e).lambda()),void 0!==t.map)return i?(this.result=t.map(e),this):t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r,t));return i?(this.result=n,this):n},this.filter=function(e){if(t=this.result||t,"string"==typeof e&&(e=miJs.string(e).lambda()),void 0!==t.filter)return i?(this.result=t.filter(e),this):t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t);return i?(this.result=n,this):n},this.distinct=function(){t=this.result||t;for(var e=[],n=0;n<t.length;n++)if(!miJs.object(t[n]).in(e)){for(var r=1,s=n+1;s<t.length;s++)if(miJs.object(t[n]).equal(t[s])&&r++,r>1){e.push(t[n]);break}1==r&&e.push(t[n])}return i?(this.result=e,this):e},this.delete=function(t){return this.filter(function(e){return!miJs.object(e).equal(t)})},this.each=function(e){if(t=this.result||t,"string"==typeof e&&(e=miJs.string(e).lambda()),void 0!==t.forEach)return i?(t.forEach(e),this):t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n,t);return i?this:void 0},this.value=function(e){return t=this.result||t,i?(this.result=t[e],this):t[e]},this.index=function(e,n){t=this.result||t;for(var r=0;r<t.length;r++)if(n?e(t[r]):miJs.object(t[r]).equal(e))return i?(this.result=r,this):r;return i?(this.result=r,this):void 0},this.object=function(){t=this.result||t;var e=miJs.object(t,i);return i?(e.result=t,e):e},this.function=function(){t=this.result||t;var e=miJs.function(t,i);return i?(e.result=t,e):e},this.reduce=function(e,n){t=this.result||t;var r=n;if("string"==typeof e&&(e=miJs.string(e).lambda()),t.reduce)r=t.reduce(e,r);else for(var s=0;s<t.length;s++)r=e(r,t[s],s,t);return i?(this.result=r,this):r},this.external=function(e,i){t=this.result||t;var n=e(t);return i&&(this.result=n),this},this.with=function(){return t=this.result||t,miniJs.this=t,i?this:void 0}}function i(t,e){var i=!!e;this.result=void 0,this.chain=function(){return i=!i,i?this:this.result},this.cache=function(){var e,n=function(){for(var e in n.base.argument)if(n.base.argument.hasOwnProperty(e)&&miniJs.object(n.base.argument[e]).equal(arguments))return n.base.retValue[e];n.base.argument.push(arguments);var i=t.apply(this,arguments);return n.base.retValue.push(i),i};return n.base={argument:[],retValue:[]},i?(e=miJs.function(n,!0),e.result=n,e):n},this.log=function(){var e,n=function(){var e=t.apply(this,arguments);return n.log.push({args:arguments,ret:e}),e};return n.log=[],i?(e=miJs.function(n,!0),e.result=n,e):n},this.clone=function(){var e,n=function(){return t.apply({},arguments)};return i?(e=miJs.function(n,!0),e.result=n,e):n},this.objectArgument=function(){var e,n=Array.prototype.slice.call(arguments),r=function(e){var i=[],r=function(t,e){miJs.object(t,!0).keys().array().each(function(s){var u=n.indexOf(e+s);-1!==u?i[u]=t[s]:r(t[s],e+s+".")})};return r(e,""),t.apply(this,i)};return i?(e=miJs.function(r,!0),e.result=r,e):r},this.profile=function(){var e,n=function(){var e=(new Date).getTime(),i=t.apply(this,arguments),r=(new Date).getTime()-e;return n.count++,n.time.all.push(r),i};return n.time={max:function(){return Math.max.apply(Math,n.time.all)},min:function(){return Math.min.apply(Math,n.time.all)},middle:function(){for(var t=0,e=0,i=n.time.all.length;i>e;e++)t+=n.time.all[e];return t/i},all:[]},n.count=0,i?(e=miJs.function(n,!0),e.result=n,e):n},this.external=function(e,n){var r=e(t),s=miJs.function(r,i);return n&&(s.result=r),s}}function n(t,e){var i=!!e;this.result=void 0,this.chain=function(){return i=!i,i?this:this.result},this.lambda=function(){var e,i=[],n=t;if(null==/\s*:\s*/.test(n))throw"String '"+t+"' can't convert to Function";return e=t.split(/\s*:\s*/),i=e[0].split(/\s*,\s*|\s+/m),n=e.slice(1).join(":"),new Function(i,"return ("+n+")")}}var r=function(r,s){return arguments.length?r instanceof Array?new e(r,s):"function"==typeof r?new i(r,s):"string"==typeof r?new n(r,s):new t(r,s):void 0};return r.object=function(e,i){return new t(e,i)},r.array=function(t,i){return new e(t,i)},r.function=function(t,e){return new i(t,e)},r.string=function(t,e){return new n(t,e)},r.alert=function(){for(var t="",e=0;e<arguments.length;e++)t+=e+": "+arguments[e]+"\n";alert(t)},r.timer=function(){var t=(new Date).getTime();return function(){return(new Date).getTime()-t}},r.this=void 0,r}();