miJs=miniJs=function(){function b(a,b){var c=!!b;this.result=void 0,this.chain=function(){return c=!c,c?this:this.result},this.clone=function(b,d){a=this.result||a;var e=function(a,b,c){var d=a instanceof Array?[]:{};for(var e in a)!!c!=(b&&b.indexOf?-1!==b.indexOf(e):miJs.object(e).in(b))&&(d[e]="object"==typeof a[e]?arguments.callee(a[e]):a[e]);return d}(a,b,d);return c?e instanceof Array?miJs.array(e,!0):(this.result=e,this):e},this.equal=function(b){a=this.result||a;var d=function(a,b){if(void 0==a||void 0==b)return a==b;if(a.length!=b.length)return!1;for(var c in a)if("object"==typeof a[c]){if(!b[c]||!arguments.callee(a[c],b[c]))return!1}else if("function"==typeof a[c]){if(""+a[c]!=""+b[c])return!1}else if(a[c]!==b[c])return!1;return void 0==a.length&&""+a!=""+b?!1:!0}(a,b);return c?(this.result=d,this):d},this.in=function(b){a=this.result||a;for(var d in b)if(miJs.object(a).equal(b[d]))return c?(this.result=!0,this):!0;return c?(this.result=!1,this):!1},this.alert=function(b,d){a=void 0!==this.result?this.result:a;var e="";for(var f in a)e+=d?miniJs.object(f).in(b)?"":f+"="+(""+a[f])+"\n":b?miniJs.object(f).in(b)?f+"="+(""+a[f])+"\n":"":f+"="+(void 0==a[f]?"":""+a[f])+"\n";return("object"!=typeof a)>(a instanceof Array)&&(e=""+a),alert(e),c?this:void 0},this.set=function(b,d){a=this.result||a;var e="function"==typeof d;for(var f in b){if(e){if(!d(a,b,f))continue}else if(d&&void 0!==a[f])continue;"object"==typeof b[f]?(void 0==a[f]&&(a[f]=b[f]instanceof Array?[]:{}),miniJs.object(a[f]).set(b[f],d)):a[f]="function"==typeof b[f]?miniJs.function(b[f]).clone():b[f]}return c?this:void 0},this.with=function(){return a=this.result||a,miniJs.this=a,c?this:void 0},this.diff=function(b,d){a=this.result||a;var e=[];for(var f in a)b[f]&&miJs.object(a[f]).equal(b[f])||e.push(f);var g=miJs.object(d?b:a).clone(e);return miJs.array(e).each(function(a){void 0==g[a]&&(g[a]=void 0)}),c?(this.result=g,this):g},this.keys=function(){if(a=this.result||a,void 0!==Object.keys)return c?(this.result=Object.keys(a),this):Object.keys(a);var b=[];for(var d in a)b.push(d);return c?(this.result=b,this):b},this.value=function(b){return a=this.result||a,c?(this.result=a[b],this):a[b]},this.key=function(b){a=this.result||a;for(var d in a)if(miJs.object(a[d]).equal(b))return c?(this.result=d,this):d;return c?(this.result=void 0,this):void 0},this.array=function(){a=this.result||a;var b=miJs.array(a,c);return c?(b.result=a,b):b},this.function=function(){a=this.result||a;var b=miJs.function(a,c);return c?(b.result=a,b):b},this.externCall=function(b,c){a=this.result||a;var d=b(a);return c&&(this.result=d),this}}function c(a,b){var c=!!b;this.result=void 0,this.chain=function(){return c=!c,c?this:this.result},this.clone=function(){return a=this.result||a,c?(this.result=a.slice(0),this):a.slice(0)},this.equal=function(b){return a=this.result||a,c?(this.result=miJs.object(a).equal(b),this):miJs.object(a).equal(b)},this.alert=function(){a=void 0!==this.result?this.result:a;var b="";for(var d in a)b+=d+"="+(""+a[d])+"\n";return"object"!=typeof a&&(b+=""+a),alert(b),c?this:void 0},this.map=function(b){if(a=this.result||a,void 0!==a.map)return c?(this.result=a.map(b),this):a.map(b);var d=[];for(var e in a)d.push(b(a[e]));return c?(this.result=d,this):d},this.filter=function(b){if(a=this.result||a,void 0!==a.filter)return c?(this.result=a.filter(b),this):a.filter(b);var d=[];for(var e in a)b(a[e])&&d.push(a);return c?(this.result=d,this):d},this.uniq=function(){a=this.result||a;var b=[];for(var d in a)if(!miJs.object(a[d]).in(b)){var e=0;for(var f in a)if(e+=miJs.object(a[d]).equal(a[f])?1:0,e>1){b.push(a[d]);break}1==e&&b.push(a[d])}return c?(this.result=b,this):b},this.delete=function(a){var b=this.filter(function(b){return!miJs.object(b).equal(a)});return c?this:b},this.each=function(b){if(a=this.result||a,void 0!==a.forEach)return c?(a.forEach(b),this):a.forEach(b);for(var d in a)b(a[d]);return c?this:void 0},this.value=function(b){return a=this.result||a,c?(this.result=a[b],this):a[b]},this.index=function(b){a=this.result||a;for(var d=0;a.length>d;d++)if(miJs.object(a[d]).equal(b))return c?(this.result=d,this):d;return c?(this.result=d,this):void 0},this.object=function(){a=this.result||a;var b=miJs.object(a,c);return c?(b.result=a,b):b},this.function=function(){a=this.result||a;var b=miJs.function(a,c);return c?(b.result=a,b):b},this.reduce=function(b,d){a=this.result||a;var e=d;if(a.reduce)e=a.reduce(b,e);else for(var f in a)e=b(a[f],e);return c?(this.result=e,this):e},this.externCall=function(b,c){a=this.result||a;var d=b(a);return c&&(this.result=d),this}}function d(a,b){var c=!!b;this.result=void 0,this.chain=function(){return c=!c,c?this:this.result},this.cache=function(){var d,b=function(){for(var c in b.base.argument)if(b.base.argument.hasOwnProperty(c)&&miniJs.object(b.base.argument[c]).equal(arguments))return b.base.retValue[c];b.base.argument.push(arguments);var d=a.apply(this,arguments);return b.base.retValue.push(d),d};return b.base={argument:[],retValue:[]},c?(d=miJs.function(b,!0),d.result=b,d):b},this.log=function(){var d,b=function(){var c=a.apply(this,arguments);return b.log.push({args:arguments,ret:c}),c};return b.log=[],c?(d=miJs.function(b,!0),d.result=b,d):b},this.clone=function(){var e,b=function(){return a.apply({},arguments)};for(var f in a)b[f]=a[f];return c?(e=miJs.function(b,!0),e.result=b,e):b},this.objectArgument=function(){var e,b=Array.prototype.slice.call(arguments),d=function(c){var d=[],e=function(a,c){miJs.object(a,!0).keys().array().each(function(f){var g=b.indexOf(c+f);-1!==g?d[g]=a[f]:e(a[f],c+f+".")})};return e(c,""),a.apply(this,d)};return c?(e=miJs.function(d,!0),e.result=d,e):d},this.profile=function(){var d,b=function(){var c=(new Date).getTime(),d=a.apply(this,arguments),e=(new Date).getTime()-c;return b.count++,b.time.all.push(e),d};return b.time={max:function(){return Math.max.apply(Math,b.time.all)},min:function(){return Math.min.apply(Math,b.time.all)},middle:function(){return miJs.array(b.time.all).reduce(function(a,b){return a+b},0)/b.time.all.length},all:[]},b.count=0,c?(d=miJs.function(b,!0),d.result=b,d):b},this.externCall=function(b,d){var e=b(a),f=miJs.function(e,c);return d&&(f.result=e),f}}var a=function(){return arguments.length?arguments[0]instanceof Array?new c(arguments[0],arguments[1]):"function"==typeof arguments[0]?new d(arguments[0],arguments[1]):new b(arguments[0],arguments[1]):void 0};return a.object=function(a,c){return new b(a,c)},a.function=function(a,b){return new d(a,b)},a.array=function(a,b){return new c(a,b)},a.alert=function(){var a="";for(var b in arguments)a+=b+": "+arguments[b]+"\n";alert(a)},a.timer=function(){var a=(new Date).getTime(),b=function(){return(new Date).getTime()-a};return b},a.this=void 0,a}();